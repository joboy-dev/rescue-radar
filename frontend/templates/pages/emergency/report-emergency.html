{% extends 'components/base-form.html' %}

{% block extra_fields %}
<p class="clear hide">Clear selection</p>
<div class="file-upload-container">
    <img src="https://cdn-icons-png.freepik.com/256/16381/16381783.png?uid=R65046554&ga=GA1.1.2092350398.1730195801&semt=ais_hybrid" alt="icon" class="icon">
    <label for="multi-file-upload" class="custom-file-upload">
        <p>Attach images</p>
        <input type="file" id="multi-file-upload" multiple accept="image/*" class="hide">
    </label>
    
    <!-- Preview area -->
    <div id="preview" class="preview"></div>
</div>

<script>
    let multiFileUploadButton = document.querySelector('#multi-file-upload');
    let clearButtton = document.querySelector('p.clear')


    multiFileUploadButton.addEventListener('change', (e) => {
        const files = e.target.files
        const previewContainer = document.getElementById('preview');
        
        // Clear any previous previews
        previewContainer.innerHTML = '';

        // Loop through selected files and display each as an image
        Array.from(files).forEach((file) => {
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    previewContainer.appendChild(img);
                };
                reader.readAsDataURL(file);
                clearButtton.classList.remove('hide')
            } else {
                alert("Only image files are allowed!");
            }
        });
    });

    clearButtton.addEventListener('click', (e) => {
        const previewContainer = document.getElementById('preview');
        previewContainer.innerHTML = '';
        clearButtton.classList.add('hide')
    });
</script>
{% endblock %}